<!DOCTYPE html>
<html>
<head>
  <title>Raspberry Pi 4 Model B 已知問題與已知操作</title>
  <link rel="icon" href="/pictures/favicon.ico" type="image/x-icon" sizes="16x16">
  <meta name="viewport" content="width=device-width, initial-scale=1" charset="UTF-8">
<style>
::selection {background: #86909A;color: white;}
::-moz-selection { /* Code for Firefox */background: #86909A;color: white;}
#myBtn {
  display: none;
  position: fixed;
  bottom: 30px;
  right: 30px;
  z-index: 99;
  font-size: 25px;
  border: none;
  outline: none;
  background-color:white;
  color:gray;
  cursor: pointer;
  padding: 15px;
  border-radius: 4px;
}
#center { /* 置中 這是HTML5用法。 <center>為HTML4用法，HTML5已不支援 */
  text-align: center;
}
a:hover, a:active {
  background-color: #FF5757;
}
a.home:link, a.home:visited {
 color:#3838BD;
}
a.home:active {
  color: red;
}
a.URL:link, a.URL:visited {
  color:#1100B6;  
}
.text_LR_move{padding-left:50px;padding-right:50px;}

body {
  background-repeat: no-repeat;
  background-attachment: fixed; 
  background-size: 100% 100%;
  background-color: white;
  color: black;
}
.dark-mode {
  background-color: black;
  color: white;
}
</style></head>
<body>
<button onclick="topFunction()" id="myBtn" title="回頂端">TOP</button>
  <noscript><h2><span style="color:#FF0000;background-color:white">注意:您的瀏覽器不支援或未開啟JavaScript功能!!</span></h2></noscript>
<script>
var mybutton = document.getElementById("myBtn");
window.onscroll = function() {scrollFunction()};

function scrollFunction() {
  if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
    mybutton.style.display = "block";
  } else {
    mybutton.style.display = "none";
  }
}
function topFunction() {
  document.body.scrollTop = 0;
  document.documentElement.scrollTop = 0;
}
</script>

<div id="center"><a href="../index.html" class="URL">回首頁</a> | <a href="#Dark" onclick="myFunction()" class="URL">夜間模式</a></div>
<script>
function myFunction() {
   var element = document.body;
   element.classList.toggle("dark-mode");
}
</script>
<h1>Raspberry Pi 4 Model B 已知問題與已知操作</div></h1>

<span style="color:#2D00C5"><a name="B"><h1>已知操作</h1></span></a>
<hr>

<div class="text_LR_move"><a name="B1"><h2>1=>初始使用Raspberry Pi</h2></a>
<h3>下載區:</h3>
<p><b>新手可以優先考慮使用<a href="https://www.raspberrypi.org/downloads/" target="_blank">Raspberry Pi Imager</a>來燒錄系統，有多種發行版可以選擇，且操作簡單</b>
  (<a href="https://downloads.raspberrypi.org/imager/imager_1.4.exe" download>Windows</a>)
  (<a href="https://downloads.raspberrypi.org/imager/imager_1.4.dmg" download>macOS</a>)
  (<a href="https://downloads.raspberrypi.org/imager/imager_1.4_amd64.deb" download>Ubuntu</a>)<br>

若不想燒錄多次但想試用多個系統，可以考慮使用<a href="https://www.raspberrypi.org/downloads/noobs/" target="_blank">NOOBS</a></p>

</p>
<h3>保護您的Raspberry Pi(Raspberry Pi OS)</h3>
<p>在基礎設定下完成之後，由於裡面設定還是預設狀態，而預設用戶pi跟Windows的Administrator權限相當，可能會有入侵風險(帶有防火牆的路由器雖安全，但也建議做)，下列操作是個人增加安全性的方法</p>
<p><i>1.用<span style="color:#065E50">passwd</span>更改pi的密碼</p></i>
<p><i>2.安裝ufw防火牆套件(詳細參見第二個網址)並設定</p></i>
<p><i>3.開始新增使用者名稱(也就是之後主要的用戶)並給予權限(詳細參見第一個網址的3、4條指令)</p></i>
<p><i>4.要求pi用戶使用sudo時要用戶密碼(詳細參見第一個網址的9、10條指令，vi的用法在倒數第二個)</p></i>
<p><i>5-1.使用<span style="color:#065E50">sudo passwd</span>指令來設定UNIX密碼(就是超級使用者(root)的密碼，權限跟Administrator相當，之後若把Pi鎖住或刪除時剛好sudo權限突然無法使用時，這應該是唯一後路了)(之後要切入超級使用者模式時，輸入<span style="color:#065E50">su</span>指令後打UNIX密碼即可進入超級使用者(root)模式，符號會從＄變成＃，若非必要盡量別常用)(設定後可能會有鎖定目標暴力破解的問題，可以去看第三個網址來防止遠端SSH登入root的問題，雖然已經有UFW防護就是了...)</p></i>
<p><i>5-2.老實說，其實使用root權限應該是比pi還要大的，若有需要用到高權限(像GUFW)還是以pi用戶為優先，所以第6步驟可以運用鎖定跟解鎖pi的動作防止長時間暴露</p></i>
<p><i>6.切換使用者後用<span style="color:#065E50">sudo passwd --lock pi</span>來鎖定pi(解鎖<span style="color:#065E50">sudo passwd --unlock pi</span>)，或刪除pi(詳細參見第一個網址的6~8條指令)，但我不建議對pi做刪除的動作，以防跟pi有關的問題發生</p></i>

<b><a href="https://www.raspberrypi.org/documentation/configuration/security.md" target="_blank">1.https://www.raspberrypi.org/documentation/configuration/security.md</a></b>
<br><br>
<b><a href="https://www.taiwaniot.com.tw/%E6%8A%80%E8%A1%93%E6%96%87%E4%BB%B6/%E6%A8%B9%E8%8E%93%E6%B4%BE%E6%8A%80%E8%A1%93%E6%96%87%E4%BB%B6/%E6%A8%B9%E8%8E%93%E6%B4%BE%EF%BC%8Draspberry%EF%BC%8C%E5%85%A7%E7%BD%AE%E7%9A%84%E9%98%B2%E7%81%AB%E7%89%86ufw%E8%A8%AD%E7%BD%AE%E5%92%8C%E5%95%9F%E7%94%A8/" target="_blank">2.https://www.taiwaniot.com.tw/%E6%8A%80%E8%A1%93%...</a></b>
<br><br>
<b><a href="https://blog.gtwang.org/linux/howto-disable-ssh-root-login-in-linux/" target="_blank">3.https://blog.gtwang.org/linux/howto-disable-ssh-root-login-in-linux/</a></b><br>
<br><br>
<p>若在新用戶裡無法使用sudo時，可查看下面網址</p>
<b><a href="https://www.itread01.com/content/1532680819.html" target="_blank">https://www.itread01.com/content/1532680819.html</a></b><br>
<hr>

<a name="B2"><h2>2=>把USB儲存裝置當主硬碟開機<span style="color:red">(現已不用，詳細從11開始)</h2></a></span>
<p><span style="color:#FF5900"><u>注意：這裡的操作只對Raspberry Pi OS有效而已，NOOBS跟其他OS可能無效</p></u></span>
<p><span style="color:#FF0000"><u>警告：本操作具有一定的風險性，若稍有錯誤可能導致開不了機的情況。請謹慎操作</p></u></span>
<h3>網址提供:</h3>
<b><a href="https://www.raspberrypi.org/documentation/hardware/raspberrypi/bcm2711_bootloader_config.md#usbmassstorageboot" target="_blank">1.https://www.raspberrypi.org/documentation/hardware/raspberrypi/bcm2711_bootloader_config.md#usbmassstorageboot</a></b>
<br><br>
<b><a href="https://www.youtube.com/watch?v=2zrwjGcyM5s" target="_blank">2.https://www.youtube.com/watch?v=2zrwjGcyM5s</a></b>
<h3>說明:</h3>
<p><u><span style="color:#1565A9">在這兩個資訊中，我推薦先看第二個網址(影片中的Firmware Update)然後再看第一個網址(USB-MSD firmware setup instructions的部份)，下面會配合影片的部份說明</p></u></span>

<p><i>1.在打開"bootloader"資料夾後，要選擇<span style="color:#065E50">stable</span>資料夾而不是影片的<span style="color:#065E50">beta</span>資料夾，因為該影片發布時還沒有穩定版可用</p></i>

<p><i>2.輸入<span style="color:#065E50">vcgencmd bootloader_version</span>後，他指定的第一行是要確認eeprom中的最後套件升級時間，而要支援USB開機就是要手動更新eeprom套件(如果日期是2020-6月多可以從6-1開始試)</p></i>

<p><i>3-1.而他接下來做的事情，其實中間省略的一個步驟，這個在他的說明欄最後兩段話有說明，我個人也是遵循他的方法(詳見4-3)，如果想按照官方作法，請看3-2，否則跳過</p></i>
<p><i>3-2.使用<span style="color:#065E50">su</span>切換為root模式時，輸入<span style="color:#065E50">vi /etc/default/rpi-eeprom-update</span>並將<span style="color:#065E50">critical</span>改為<span style="color:#065E50">stable</span>，這個在第一個網址裡"Update the bootloder"裡的第二行"As root, edit"那一部分</p></i>

<p><i>4-1.輸入<span style="color:#065E50">sudo rpi-eeprom-update -d -f </span>後，把<span style="color:#065E50">stable</span>點開來後找<span style="color:#065E50">pieeprom</span>開頭後面日期比較新的，並把該檔案的路徑打上去，不懂可以看4-2範例修改</p></i>
<p><i>4-2.ex:<span style="color:#065E50">sudo rpi-eeprom-update -d -f /lib/firmware/raspberrypi/bootloader/stable/pieeprom-2020-07-16.bin</span></p></i>
<p><i>4-3.在3-1提到會做不更動的動作是因為做<span style="color:#065E50">sudo rpi-eeprom-update -d -f </span>的<span style="color:#065E50">-d -f</span>強制動作時就會忽略<span style="color:#065E50">rpi-eeprom-update</span>的範圍設置，若選擇為<span style="color:#065E50">stable</span>未來的可能會接收到<span style="color:#065E50">stable</span>版的更新套件而不是原始的<span style="color:#065E50">critical</span>版套件，相對選<span style="color:#065E50">critical</span>若更新eeprom套件時可能會有刷回去一開始無法使用USB開機風險(事實證明不會，就算<span style="color:#065E50">critical</span>日期比<span style="color:#065E50">stable</span>還新也是不會換掉，但也因此要手動處裡eeprom套件)，穩定程度<span style="color:#065E50">critical</span> > <span style="color:#065E50">stable</span> > <span style="color:#065E50">beta</span>(關鍵>穩定>測試)</p></i>

<p><i>5-1.完成之後照影片方式重新啟動</p></i>
<p><i>5-2.再次輸入<span style="color:#065E50">vcgencmd bootloader_version</span>查看是否和<span style="color:#065E50">pieeprom</span>後寫的日期一致</p></i>

<p><i>6-1.在影片的15:12中，插入日後要當主硬碟USB裝置後，並注意SD Card Copier的Copy from跟Copy to(from是指來源，to是指定到)，一旦反了可能就變成SD卡的資料消失了</p></i>
<p><i>6-2.假如SD卡或USB裝置資料真的搞消失了日後也不需要在做4-1跟4-2的步驟，3-2若一開始有去改的話再去改一下就可以了</p></i>

<p><i>7.copy完成後先關機並切斷電源，然後把SD卡抽走後在通電開機，若能成功進入彩屏畫面就表示成功了</p></i>
<br>
<p><i>11.自9/20後<span style="color:#065E50">critical</span>資料夾新增了9/3的eeprom套件，所以在更新跟升級時系統會自動安裝，如果有做上述步驟(且不做步驟3-2)者，建議可以直接刷回<span style="color:#065E50">critical</span>版本，不需再繼續用<span style="color:#065E50">stable</span>版本的eeprom套件</p></i>

<p><i>12.如果樹莓派偵測不到USB開機碟，插回sd卡打開終端機輸入<span style="color:#065E50">vcgencmd bootloader_version</span>看日期是不是<span style="color:#065E50">Sep 3 2020</span>或更後面的日期，是的話可能要檢查USB儲存的資料有無問題，不是的話參考4-1跟4-2的範例，但要注意資料夾是<span style="color:#065E50">critical</span>而非<span style="color:#065E50">stable</span>，更不是<span style="color:#065E50">beta</span>!!</p></i>
<hr>

<a name="B3"><h2>3=>定期備份系統資料<span style="color:red">(可能多半無效!!)</span></h2></a>
<p><span style="color:#FF5900"><u>注意:這是我嘗試出來的結果，不確定是否真的有用</p></u></span>
<p><b>(建議可以用它來備份自己的檔案到其他地方，算是相當方便的工具)</b></p>
<p><i>1.使用<span style="color:#065E50">sudo apt install backintime-gnome</span>進行安裝</p></i>
<p><i>2.安裝好後，去"開始(樹莓派LOGO)">"系統工具">"Back In Time(root)"輸入root或pi的密碼</p></i>
<p><i>3.去"snapshot">"設定"</p></i>
<p><i>4.設好"快照存放位置"跟排程時間</p></i>
<p><i>5.點擊"包含"後並點"Modify for Full System Backup"確認有跑出一個"/"的資料夾</p></i>
<p><i>6.點擊"不包含"後點擊"新增資料夾"將路徑"/home"跟"/media"加入除外名單中</p></i>
<p><i>7.點擊"自動移除"後打勾"時間超過"並設定你要它自動刪除的天數，我幾乎每天都用所以是輸入5並選擇天，也就是5天後的檔案會自動刪除，下面的"剩餘空間少於"跟"If free inodes is less than"打勾並保持默認值就好(或者這兩個可不勾?我是不太清楚)</p></i>
<p><i>8.確認設定的資料沒問題後點擊"OK"即可完成，只要到了或超過你指定的時間就會開始備份</p></i>
<p><i>9.若想還原的話，去"開始(樹莓派LOGO)">"系統工具">"Back In Time(root)"輸入root或pi的密碼後，點擊要還原的日期時間，按上方"還原">"還原"，跳出視窗後點擊"Yes"(勾的用途我不太確定，所以沒去勾)即可還原</p></i>
<hr>

<a name="B4"><h2>4=>手動更新時間</h2></a>
<p><i>1.輸入<span style="color:#065E50">sudo apt install ntpdate</span>後輸入<span style="color:#065E50">sudo ntpdate -s time.stdtime.gov.tw</span>即可更新Raspberry Pi時間</p></i>
<p><i>2.若輸入<span style="color:#065E50">sudo ntpdate -s time.stdtime.gov.tw</span>仍然無法更新時間的話，可以嘗試看看以下的時間伺服器網址或是參考連結</p></i>
<p><i>tock.stdtime.gov.tw</p></i>
<p><i>watch.stdtime.gov.tw</p></i>
<p><i>clock.stdtime.gov.tw</p></i>
<p><i>tick.stdtime.gov.tw</p></i>
<a href="https://p501lab.blogspot.com/2014/09/ntp_29.html" target="_blank"><span style="font-weight:bold">https://p501lab.blogspot.com/2014/09/ntp_29.html</a></span>
<hr>

<a name="B5"><h2>5=>開啟video acceleration(影片解碼加速)<span style="color:red">(更新已有解決這方面的問題，可以不用做)</span></h2></a>
<p><i>1.開啟video acceleration可有效使用Raspberry Pi的GPU性能，避免影片及圖像跑動等過度卡頓或緩慢</p></i>
<p><i>2.以下連結為開啟影片解碼加速操作方式，不懂可以用Google翻譯功能</p></i>
<p><span style="color:#FF5900"><i>要注意一下:這個啟用後chromium打開youtube觀看時可能會有錯誤發生，保守者勿做</i></span></p>
<a href="https://www.dedoimedo.com/computers/rpi4-ubuntu-mate-hw-video-acceleration.html" target="_blank"><span style="font-weight:bold">https://www.dedoimedo.com/computers/rpi4-ubuntu-mate-hw-video-acceleration.html</a></span></div>
</div>
<hr>
<br><br><br>
<span style="color:#9800C5"><a name="A"><h1>已知問題</h1></span></a>
<hr>
<div class="text_LR_move"><p><span style="font-weight:bold"><u>!!參考此篇前請先詳閱<a href="./data3.html">Raspberry Pi 已知說明</span></a></u></p>
<a name="A1"><h2>USB部份</h2></a>
<p><i>1.若要提供SSD、HDD、光碟機這樣的高耗電外接裝置時，在足夠電力的情況下只能選一個來使用，若同時使用兩個會不夠電並發生問題</i></p>
<p><i>2.若上述要使用2個以上時，只能接HUB並確保線材與電源提供電量充足</p></i>
<p><i>3.使用像Argon one有帶電源鍵的外殼，若在HUB有接電源的情況下可能會有開不了機的情況，重新插拔HUB的電源線即可解決</i></p>
<a name="A2"><h2>音訊部份</h2></a>
<p><span style="color:red">(已修復!!Fixed)</span><i><del>1.使用音效卡只能打開一個音訊程式，打開第二個會顯示忙碌或錯誤</del></i></p>
<p><i>1.若有用Argon one外殼，要注意音訊孔有些可能會插不夠深，導致只有單喇叭播放</i></p>
<p><i>2.連續對VLC播放器做跳轉動作可能會有短暫降音的情況</i></p>
<p><i>3.若連接藍芽出現"pulseaudio"找不到該裝置的情況下，代表它可能還用bluealsa套件造成的，試輸入<span style="color:#065E50">sudo apt install pulseaudio-module-bluetooth</span>安裝看看，若出現newest那可能不是該套件問題</i></p>
<a name="A3"><h2>硬碟與記憶體部份</h2></a>
<p><i>1-1.使用SD卡作主硬碟使用會有卡住的情況，屬正常現象。因為SD卡有多數(尤其是便宜貨)沒辦法負荷太多同時讀取與寫入的窘境，再加上使用虛擬記憶體的問題更考驗讀寫速度與延遲。建議去[ 開始 > 附屬應用程式 > Raspberry Pi Diagnostics ]進行SD卡測試，若出現Fail狀態就不建議繼續使用這張SD卡</i></p>
<p><i>1-2.若不想試人品及長其使用建議<a href="#B2">用SSD作主硬碟使用</a>，前提是確定電力提供穩定，<b>不要出現任何的降電壓符號!!</i></b></p>
<p><i>2.建議在執行格式化或移動檔案這樣的操作時，別執行其他程式來多工操作，避免記憶體使用量過高強關或重起導致資料毀損，也確保沒有顯示降電壓符號</i></p>
<p><i>3.在使用 "SD card copier" 時，<b>"禁止拔掉或接上其他的USB裝置!!"</b>複製進度會強制取消</i></p>
<a name="A0"><h2>其他部份</h2></a>
<p><i>1.GPIO建議不要做熱插拔的動作，更不能短路3V3接腳，否則易造成損壞(Raspberry Pi 3 Model B+只要GND或5V去接觸3V3接腳，直接掛點!)</i></p>
<p><i>2.若出現降電壓符號或系統停擺時，確認電源跟線材的負荷量以及USB或GPIO的耗電量，做出適當的調整</i></p></div>
<hr>
<br><br><br>

<span id="center"><p><u><i><b>E N D</b></i></u></p></span>
</body>
</html>
