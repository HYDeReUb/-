<!DOCTYPE html>
<html><title>20201006_SQL</title>
<head><meta name="viewport" content="width=device-width, initial-scale=1">
<style>
#myBtn {
  display: none;
  position: fixed;
  bottom: 30px;
  right: 30px;
  z-index: 99;
  font-size: 25px;
  border: none;
  outline: none;
  background-color:white;
  color:gray;
  cursor: pointer;
  padding: 15px;
  border-radius: 4px;
}
a:hover, a:active {
  background-color: #FF5757;
}
a.home:link, a.home:visited {
 color:#3838BD;
}
a.home:active {
  color: red;
}
</style></head>
<body>
<button onclick="topFunction()" id="myBtn" title="回頂端">TOP</button>
  <noscript><h2><span style="color:#FF0000;background-color:white">注意:您的瀏覽器不支援或未開啟JavaScript功能!!</span></h2></noscript>
<script>
var mybutton = document.getElementById("myBtn");
window.onscroll = function() {scrollFunction()};

function scrollFunction() {
  if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
    mybutton.style.display = "block";
  } else {
    mybutton.style.display = "none";
  }
}
function topFunction() {
  document.body.scrollTop = 0;
  document.documentElement.scrollTop = 0;
}
</script>


<center><a href="../index.html" class="home">回教師上課資料</a></center>
<h1>20201006_SQL</h1>
<br>
<a href="./sqldown/20201006_SQL.zip" class="home">20201006_SQL範例下載(zip檔)</a>
  <p>-- 聚合函數</p>
  <p>--統計所有學生數</p>
  <p>SELECT COUNT(sid) AS 學生數 FROM students</p><br>
  <p>-- 統計所有GPA>3的學生數(兩種方法)</p>
  <p>SELECT COUNT(sid) AS GPA較高學生數 FROM students WHERE gpa > 3</p>
  <p>SELECT COUNT(*) AS GPA較高學生數 FROM students WHERE gpa > 3</p><br>
  <p>-- 統計 學生的 GPA 加總(SUM)，平均(AVG)，最高(MAX)，最低(MIN)</p>
  <p>SELECT SUM(gpa) TOTAL_GPA, AVG(gpa) AVERAGE_GPA, MAX(gpa) MAXIMUM_GPA, MIN(gpa) MINIMUM_GPA FROM students</p>
  <p>SELECT SUM(gpa) gpa加總, AVG(gpa) 平均gpa, MAX(gpa) 最高gpa, MIN(gpa) 最低gpa FROM students</p><br>
  <p>-- ??</p>
  <p>SELECT MAX(score) 最高成績, MIN(score) 最低成績, AVG(score) 平均成績 FROM classes WHERE sid = "S001"</p><br>
  <p>-- 找出S001的修課選課數，最高成績，最低成績，平均成績</p>
  <p>SELECT sid 學號, COUNT(*) 選課數, MAX(score) 最高成績, MIN(score) 最低成績, AVG(score) 平均成績 FROM classes WHERE sid = 'S001'</p><br>
  <p>-- 列出所有每位學生的修課選課數，最高成績，最低成績，平均成績</p>
  <p>SELECT sid 學號, COUNT(*) 選課數, MAX(score) 最高成績, MIN(score) 最低成績, AVG(score) 平均成績 FROM classes GROUP BY sid</p><br>
  <p>-- 列出每位教師(eid)所開的課程的課程數，及學生的平均成績</p>
  <p>SELECT eid 教師, COUNT(*) 開課數, AVG(score) 學生的平均成績 FROM classes GROUP BY eid</p><br>
  <p>-- 列出所有課程(c_no)的學生數(count)</p>
  <p>SELECT c_no 課程, COUNT(*) 學生數 FROM classes GROUP BY c_no</p>
  <p>-- 列出課程CS222(c_no)的學生數(count)</p>
  <p>SELECT c_no 課程, COUNT(*) 學生數 FROM classes WHERE c_no ='CS222' GROUP BY c_no</p><br>
  <p>-- HAVING 群組條件</p>
  <p>-- 列出課程的學生數(count)>=2的課程</p>
  <p>-- 錯誤****SELECT c_no 課程, COUNT(*) 學生數 FROM classes WHERE COUNT(sid) > 2 GROUP BY c_no</p>
  <p>SELECT c_no 課程, COUNT(*) 學生數 FROM classes GROUP BY c_no HAVING COUNT(*) >= 2</p><br>
  <h3>使用 NorthWind 資料庫</h3>
  <p>-- 列出[飛狐工作室]的所有部門的各部門人數，平均薪資(目前薪資)，最高薪資，最低薪資(下面2條命令是一起的)</p>
  <p>SELECT 部門, COUNT(*) 人數, AVG(目前薪資) 平均薪資, MAX(目前薪資) 最高薪資, MIN(目前薪資) 最低薪資 FROM 飛狐工作室 GROUP BY 部門</p>
  <p>HAVING AVG(目前薪資)>30000</p><br>
  <p>-- 列出所有各姓氏的人數</p>
  <p>SELECT LEFT(姓名, 1) AS 姓氏, COUNT(*) 人數 FROM 飛狐工作室 GROUP BY LEFT(姓名, 1)</p><br>
  <p>-- 列出在公司內同姓名共多少人</p>
  <p>SELECT 姓名, COUNT(*) 人數 FROM 飛狐工作室 GROUP BY 姓名 HAVING COUNT(*)>1</p><br>
  <p>-- 列出所有各姓氏的人數(以人數作排序，大->小)</p>
  <p>SELECT LEFT(姓名, 1) AS 姓氏, COUNT(*) 人數 FROM 飛狐工作室 GROUP BY LEFT(姓名, 1) ORDER BY 人數 DESC</p><br>
  
    <br><br><br>
    <center><p><u><i><b>E N D</p></u></i></b></center>
</body></html>
